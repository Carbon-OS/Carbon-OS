local url = http.get("https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/System/latestversion")

local files = {
    [1] = {
        "/System/Images/boot",
        "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/System/Images/boot"
    },
    [2] = {
        "startup",
        "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/startup"
    },
    [3] = {
        "/Programs/LuaIDE/program",
        "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/Programs/LuaIDE/program"
   },
   [4] = {
       "/Programs/Sketch/program",
       "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/Programs/Sketch/program"
   },
   [5] = {
       "/Desktop/LuaIDE",
       "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/Desktop/LuaIDE"
  },
  [6] = {
      "/Desktop/Sketch",
      "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/Desktop/Sketch"
  },
  [7] = {
      "/System/Images/desktop",
      "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/System/Images/desktop"
 },
 [8] = {
     "/System/settings",
     "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/System/settings"
 },
 [9] = {
     "/System/autoupdater",
     "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/System/autoupdater"
 },
 [10] = {
      "/System/.version",
      "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/System/.version"
 },
 [11] = {
      "/os",
      "https://raw.githubusercontent.com/Carbon-OS/CarbonOS/master/os"
 }
}  
    shell.run("cd", "/System")
    tmpc = fs.open("/System/.version", "r")
    local f = fs.open("/System/.version","r")
    local currentVersion = f.readAll()
    f.close()
    local hget = http.get(url)
    local remoteVersion = hget.readAll()
    hget.close()
    if not currentVersion == remoteVersion then
       fs.delete("latestversion")
       shell.run("cd", "/")
       fs.delete("/System")
       fs.delete("/Programs")
       fs.delete("/Desktop")
       print("Updating...")
       for k,v in pairs(files) do
       print("Downloading ", v[2], "...")
       req = http.get(v[2])
       if req ~= nil then
           code = req.readAll()
           req.close()
       else
           print("Failed!")
       end

       file = fs.open(v[1], "w")
       file.write(code)
       file.close()
    else
       shell.run("/os")
    end
 end
